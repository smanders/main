--- jasper-1.900.1/src/libjasper/base/jas_image.c	2007-01-19 22:43:05.000000000 +0100
+++ jasper-1.900.1/src/libjasper/base/jas_image.c	2016-01-28 15:40:15.211217898 +0100
@@ -426,7 +426,7 @@
 		return -1;
 	}
 
-	if (jas_matrix_numrows(data) != height || jas_matrix_numcols(data) != width) {
+	if (!height || !width || jas_matrix_numrows(data) != height || jas_matrix_numcols(data) != width) {
 		if (jas_matrix_resize(data, height, width)) {
 			return -1;
 		}
@@ -479,7 +479,7 @@
 		return -1;
 	}
 
-	if (jas_matrix_numrows(data) != height || jas_matrix_numcols(data) != width) {
+	if (!height || !width || jas_matrix_numrows(data) != height || jas_matrix_numcols(data) != width) {
 		return -1;
 	}
 
--- jasper-1.900.1/src/libjasper/base/jas_seq.c	2007-01-19 22:43:05.000000000 +0100
+++ jasper-1.900.1/src/libjasper/base/jas_seq.c	2016-01-28 15:46:12.314936079 +0100
@@ -262,6 +262,8 @@
 	int rowstep;
 	jas_seqent_t *data;
 
+	if (!matrix || !matrix->numrows_ || !matrix->rows_)
+		return;
 	rowstep = jas_matrix_rowstep(matrix);
 	for (i = matrix->numrows_, rowstart = matrix->rows_[0]; i > 0; --i,
 	  rowstart += rowstep) {
@@ -282,6 +284,8 @@
 	jas_seqent_t *data;
 	int rowstep;
 
+	if (!matrix || !matrix->numrows_ || !matrix->rows_)
+		return;
 	rowstep = jas_matrix_rowstep(matrix);
 	for (i = matrix->numrows_, rowstart = matrix->rows_[0]; i > 0; --i,
 	  rowstart += rowstep) {
@@ -307,6 +311,8 @@
 	jas_seqent_t *data;
 
 	assert(n >= 0);
+	if (!matrix || !matrix->numrows_ || !matrix->rows_)
+		return;
 	rowstep = jas_matrix_rowstep(matrix);
 	for (i = matrix->numrows_, rowstart = matrix->rows_[0]; i > 0; --i,
 	  rowstart += rowstep) {
@@ -325,6 +331,8 @@
 	int rowstep;
 	jas_seqent_t *data;
 
+	if (!matrix || !matrix->numrows_ || !matrix->rows_)
+		return;
 	rowstep = jas_matrix_rowstep(matrix);
 	for (i = matrix->numrows_, rowstart = matrix->rows_[0]; i > 0; --i,
 	  rowstart += rowstep) {
@@ -367,6 +375,8 @@
 	int rowstep;
 	jas_seqent_t *data;
 
+	if (!matrix || !matrix->numrows_ || !matrix->rows_)
+		return;
 	rowstep = jas_matrix_rowstep(matrix);
 	for (i = matrix->numrows_, rowstart = matrix->rows_[0]; i > 0; --i,
 	  rowstart += rowstep) {
@@ -395,7 +405,7 @@
 	if (!(matrix = jas_seq2d_create(xoff, yoff, xoff + numcols, yoff + numrows)))
 		return 0;
 
-	if (jas_matrix_numrows(matrix) != numrows || jas_matrix_numcols(matrix) != numcols) {
+	if (!matrix || jas_matrix_numrows(matrix) != numrows || jas_matrix_numcols(matrix) != numcols) {
 		abort();
 	}
 
